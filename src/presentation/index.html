<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>キーボードタイピングゲーム</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <div id="app">
        <header class="game-header">
            <h1>🎮 キーボードタイピングゲーム 🎮</h1>
            <div class="game-status">
                <span id="game-state">準備中</span>
            </div>
        </header>

        <main class="game-container">
            <!-- ゲーム設定画面 -->
            <section id="setup-screen" class="screen active">
                <div class="setup-panel">
                    <div class="setup-header">
                        <h2>ゲーム設定</h2>
                        <div class="setup-controls">
                            <button id="save-config-btn" class="btn btn-secondary">設定保存</button>
                            <button id="load-config-btn" class="btn btn-secondary">設定読込</button>
                        </div>
                    </div>
                    
                    <!-- 基本設定 -->
                    <div class="settings-section">
                        <h3>基本設定</h3>
                        <div class="settings-grid">
                            <div class="setting-group">
                                <label for="config-name">設定名:</label>
                                <input type="text" id="config-name" class="setting-input" placeholder="設定名を入力">
                            </div>
                            
                            <div class="setting-group">
                                <label for="team-count">チーム数:</label>
                                <select id="team-count" class="setting-input">
                                    <option value="2">2チーム</option>
                                    <option value="3">3チーム</option>
                                    <option value="4">4チーム</option>
                                    <option value="5">5チーム</option>
                                    <option value="6">6チーム</option>
                                    <option value="7">7チーム</option>
                                    <option value="8">8チーム</option>
                                </select>
                            </div>

                            <div class="setting-group">
                                <label for="difficulty">難易度:</label>
                                <select id="difficulty" class="setting-input">
                                    <option value="easy">やさしい</option>
                                    <option value="normal">ふつう</option>
                                    <option value="hard">むずかしい</option>
                                </select>
                            </div>

                            <div class="setting-group">
                                <label for="game-duration">ゲーム時間:</label>
                                <select id="game-duration" class="setting-input">
                                    <option value="30">30秒</option>
                                    <option value="60" selected>60秒</option>
                                    <option value="90">90秒</option>
                                    <option value="120">120秒</option>
                                    <option value="180">180秒</option>
                                </select>
                            </div>

                            <div class="setting-group">
                                <label for="word-category">お題カテゴリ:</label>
                                <select id="word-category" class="setting-input">
                                    <option value="mixed">ミックス</option>
                                    <option value="animals">動物</option>
                                    <option value="foods">食べ物</option>
                                    <option value="colors">色</option>
                                    <option value="nature">自然</option>
                                    <option value="family">家族</option>
                                    <option value="school">学校</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- チーム設定 -->
                    <div class="settings-section">
                        <h3>チーム設定</h3>
                        <div id="team-settings" class="team-settings">
                            <!-- 動的に生成 -->
                        </div>
                    </div>

                    <!-- プレイヤー管理 -->
                    <div class="settings-section">
                        <h3>プレイヤー管理</h3>
                        <div class="player-section">
                            <div class="player-input-area">
                                <input type="text" id="player-name-input" class="setting-input" placeholder="プレイヤー名を入力" maxlength="20">
                                <button id="add-player-btn" class="btn btn-secondary">プレイヤー追加</button>
                            </div>
                            <div class="player-list">
                                <h4>参加プレイヤー (<span id="player-count">0</span>人)</h4>
                                <div id="players-container" class="players-container">
                                    <!-- 動的に生成 -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- チームメンバー割り当て -->
                    <div class="settings-section">
                        <h3>チームメンバー割り当て</h3>
                        <div class="team-assignment-section">
                            <div class="assignment-controls">
                                <div class="assignment-strategy">
                                    <label for="assignment-strategy">割り当て方法:</label>
                                    <select id="assignment-strategy" class="setting-input">
                                        <option value="sequential">順番通り</option>
                                        <option value="random">ランダム</option>
                                        <option value="manual">手動指定</option>
                                    </select>
                                </div>
                                <button id="assign-players-btn" class="btn btn-primary">メンバー割り当て</button>
                            </div>
                            <div id="team-members-display" class="team-members-display">
                                <!-- 動的に生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- ターン順設定 -->
                    <div class="settings-section">
                        <h3>ターン順設定</h3>
                        <div class="turn-order-section">
                            <div class="turn-order-controls">
                                <div class="turn-order-strategy">
                                    <label for="turn-order-strategy">ターン順決定方法:</label>
                                    <select id="turn-order-strategy" class="setting-input">
                                        <option value="sequential">追加順</option>
                                        <option value="random">ランダム</option>
                                        <option value="alphabetical">あいうえお順</option>
                                        <option value="manual">手動指定</option>
                                    </select>
                                </div>
                                <button id="decide-turn-order-btn" class="btn btn-primary">ターン順決定</button>
                            </div>
                            <div id="turn-order-display" class="turn-order-display">
                                <!-- 動的に生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- キーボード設定 -->
                    <div class="settings-section">
                        <h3>キーボード設定</h3>
                        <div class="keyboard-section">
                            <div class="keyboard-status">
                                <span id="keyboard-count">0</span>台のキーボードが検知されています
                                <button id="refresh-keyboards-btn" class="btn btn-small">再検索</button>
                            </div>
                            <div id="keyboard-assignment" class="keyboard-assignment">
                                <!-- 動的に生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 音響設定 -->
                    <div class="settings-section">
                        <h3>音響設定</h3>
                        <div class="sound-settings">
                            <div class="setting-group">
                                <label for="master-volume">音量:</label>
                                <input type="range" id="master-volume" class="volume-slider" min="0" max="100" value="70">
                                <span id="volume-display">70%</span>
                            </div>
                            <div class="sound-toggles">
                                <label class="toggle-label">
                                    <input type="checkbox" id="sound-effects" checked>
                                    <span class="toggle-slider"></span>
                                    効果音
                                </label>
                                <label class="toggle-label">
                                    <input type="checkbox" id="typing-sound" checked>
                                    <span class="toggle-slider"></span>
                                    タイピング音
                                </label>
                                <label class="toggle-label">
                                    <input type="checkbox" id="background-music">
                                    <span class="toggle-slider"></span>
                                    BGM
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="setup-actions">
                        <button id="start-game-btn" class="btn btn-primary btn-large">
                            ゲーム開始
                        </button>
                        <div class="setup-status" id="setup-status">
                            設定を確認してください
                        </div>
                    </div>
                </div>
            </section>

            <!-- ゲーム画面 -->
            <section id="game-screen" class="screen">
                <div class="game-info">
                    <div class="current-word">
                        <h2 id="target-word">単語が表示されます</h2>
                    </div>
                    <div class="game-timer">
                        <span id="timer">60</span>秒
                    </div>
                </div>

                <div id="teams-container" class="teams-container">
                    <!-- チーム表示エリア（動的に生成） -->
                </div>
            </section>

            <!-- 結果画面 -->
            <section id="result-screen" class="screen">
                <div class="result-panel">
                    <h2>🏆 ゲーム結果 🏆</h2>
                    <div id="results-list" class="results-list">
                        <!-- 結果表示（動的に生成） -->
                    </div>
                    <button id="restart-btn" class="btn btn-primary btn-large">
                        もう一度遊ぶ
                    </button>
                </div>
            </section>
        </main>
    </div>

    <script src="simple-renderer.js"></script>
    <script>
        // フォールバックスクリプト：メインのJSが動作しない場合のバックアップ
        document.addEventListener('DOMContentLoaded', function() {
            const startBtn = document.getElementById('start-game-btn');
            if (startBtn && startBtn.disabled) {
                // ボタンが無効な場合は有効にする
                startBtn.disabled = false;
                console.log('フォールバック: ゲーム開始ボタンを有効化しました');
            }
            
            // ボタンクリックイベントを追加（まだ追加されていない場合）
            if (startBtn && !startBtn.onclick) {
                startBtn.onclick = function() {
                    alert('デモモード: ゲームを開始します！\n\n実際のゲーム機能を実装するには、renderer.jsの読み込みが必要です。');
                };
            }
        });
    </script>
</body>
</html>